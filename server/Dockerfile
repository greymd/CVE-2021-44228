FROM openjdk:17.0.1-slim AS builder
WORKDIR /app/
COPY . .
RUN rm -rf ./build && ./gradlew install && ./gradlew build

FROM openjdk:17.0.1-slim
WORKDIR /app/
COPY --from=builder /app/build /app/build
EXPOSE 1389 1389/tcp
CMD [ "/bin/bash","-c","java -cp \"$(find /app/build/ -iname '*.jar' | paste -sd :)\" server.App" ]
